<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login & Register</title>
</head>
<body>
    <h1>Login & Register</h1>
    
    <div id="register">
        <h2>Register</h2>
        <label for="reg-username">Username:</label>
        <input type="text" id="reg-username" required><br>
        <label for="reg-email">Email:</label>
        <input type="email" id="reg-email" required><br>
        <label for="reg-password">Password:</label>
        <input type="password" id="reg-password" required><br>
        <button onclick="registerUser()">Register</button>
    </div>

    <div id="login">
        <h2>Login</h2>
        <label for="login-identifier">Username or Email:</label>
        <input type="text" id="login-identifier" required><br>
        <label for="login-password">Password:</label>
        <input type="password" id="login-password" required><br>
        <button onclick="loginUser()">Login</button>
    </div>

    <script>
        // Hashing function using SHA-256
async function hashPassword(password) {
    const encoder = new TextEncoder();
    const data = encoder.encode(password);
    const hash = await crypto.subtle.digest('SHA-256', data);
    return Array.from(new Uint8Array(hash)).map(b => b.toString(16).padStart(2, '0')).join('');
}

// Function to register a new user
async function registerUser() {
    const username = document.getElementById('reg-username').value;
    const email = document.getElementById('reg-email').value;
    const password = document.getElementById('reg-password').value;

    const userData = JSON.parse(localStorage.getItem('userData')) || {};

    if (username in userData) {
        alert("Username already exists.");
        return;
    }

    for (const user in userData) {
        if (userData[user].email === email) {
            alert("Email already registered.");
            return;
        }
    }

    const hashedPassword = await hashPassword(password);
    userData[username] = { email: email, password: hashedPassword };
    localStorage.setItem('userData', JSON.stringify(userData));

    alert("User registered successfully!");
}

// Function to log in a user
async function loginUser() {
    const identifier = document.getElementById('login-identifier').value;
    const password = document.getElementById('login-password').value;

    const userData = JSON.parse(localStorage.getItem('userData')) || {};
    const hashedPassword = await hashPassword(password);

    for (const username in userData) {
        if ((identifier === username || identifier === userData[username].email) &&
            hashedPassword === userData[username].password) {
            alert("Login successful!");
            return;
        }
    }

    alert("Invalid username/email or password.");
}

    </script>
</body>
</html>
